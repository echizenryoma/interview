## 网络层

### IPv4协议头部

<table style="tr th { text-align: 'center'; }; td { align: 'center'; }">
<tbody>
<tr>
<th>位偏移</th>
<th colspan="4">0–3</th>
<th colspan="4">4–7</th>
<th colspan="6">8–13</th>
<th colspan="2">14-15</th>
<th colspan="3">16–18</th>
<th colspan="13">19–31</th>
</tr>
<tr>
<th>0</th>
<td colspan="4">版本</td>
<td colspan="4">首部长度</td>
<td colspan="6">区分服务</td>
<td colspan="2">显式拥塞通告</td>
<td colspan="16">全长</td>
</tr>
<tr>
<th>32</th>
<td colspan="16">标识符</td>
<td colspan="3">标志</td>
<td colspan="13">分片偏移</td>
</tr>
<tr>
<th>64</th>
<td colspan="8">存活时间</td>
<td colspan="8">协议</td>
<td colspan="16">首部检验和</td>
</tr>
<tr>
<th>96</th>
<td colspan="32">源IP地址</td>
</tr>
<tr>
<th>128</th>
<td colspan="32">目的IP地址</td>
</tr>
<tr>
<th>160</th>
<td colspan="32">选项（如首部长度&gt;5）</td>
</tr>
</tbody></table>

### IPv4地址分类

|  | **前缀（二进制）** | **掩码位数** |**网络地址位数** | **主机地址位数** |
| :---: | :---: | :---: | :---: | :---: |
| A类地址 | 0 | 8 | 7 | 24 |
| B类地址 | 10 | 16 | 14 | 16 |
| C类地址 | 110 | 24 | 21 | 8 |
| D类地址 | 1110 | - | - | - |
| E类地址 | 11110 | - | - | - |

D类地址：多目的广播地址（28位）
E类地址：保留用于实验和将来使用

### 特殊的IPv4地址

* 主机号全为0表示本网络本身
* 主机号全为1表示本网络的广播地址
* `127.0.0.0/8`网络保留作为环路自检地址
* `169.254.0.0/16`是保留的`link local`网段，当不能获得DHCP服务时，自动配置的系统被分配这个网段的地址
* `0.0.0.0`表示整个TCP/IP网络
* `255.255.255.255`表示整个TCP/IP网络的广播地址

### 私有IPv4地址网段

* `10.0.0.1`~`10.255.255.254`/`10.0.0.0/8`
* `172.16.0.1`~`172.31.255.254`/`172.16.0.0/12`
* `192.168.0.0`~`192.168.255.254`/`192.168.0.0/16`
