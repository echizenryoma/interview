## 传输层

### TCP/IP协议栈

![TCP/IP协议栈](/assets/tcp-ip-protocol-stack.svg)

最左边的网络应用tcpdump直接使用BPF (BSD 分组过滤器）或 DLPI（数据链路提供者接口）同数据链路层进行通信。ping使用ICMP协议。

### UDP

用户数据报协议（User Datagram Protocol）：无连接的，数据传输的单位是用户数据报，不保证提供可靠的交付，只能提供“尽最大努力交付”。

1. UDP是一种无连接协议。
2. UDP不是可靠的，不能保证最终到达它们的目的地，不保证各个数据报的先后顺序跨网络保持不变， 也不保证每个数据报只到达一次

### TCP

传输控制协议（Transmission Control Protocol）：面向连接的，数据传输的单位是报文段，能够提供可靠的交付。

1. TCP是一种面向连接的协议，提供客户与服务器的连接。
2. TCP提供可靠性。当使用TCP向另一端发送数据时， 它要求对端返回一个确认。如果没有收到确认，TCP自动重传数据并等待更长时间。在数次重传失败后，TCP才放弃。
3. TCP通过给所发送数据的每一个字节关联一个序列号进行排序。UDP 提供不可靠的数据报传送不提供确认、 序列号、 超时重传等机制。
4. TCP 提供流量控制，而UDP 不提供流量控制。TCP 总是告诉对端它能够接收多少字节的数据，这称为**通告窗口**。该窗口在任何时刻都指出接收缓冲区中的可用空间， 从而确保发送端发送的数据不会溢出接收缓冲区。

UDP与TCP的主要区别在于UDP**不一定提供**（但是可以自己实现）可靠的数据传输。事但是，UDP在许多方面非常有效，比如：UDP具有对系统资源要求较少、具有较好的实时性、 网络开销小的优点。当某个程序的目标是尽快地传输尽可能多的信息时（其中任意给定数据的重要性相对较低），可使用UDP。