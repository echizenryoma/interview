## 分组密码

### 工作模式

分组密码算法只能加密固定长度的分组，若要加密变长数据，则数据必须先被划分为一些单独的密码块。通常而言，最后一块数据也需要使用合适填充方式将数据扩展到匹配密码块大小的长度。对于变长数据需要对分组密码算法进行迭代，以便将明文全部加密。而迭代的方法就称为分组密码的模式（mode），主要有以下模式：

* `ECB`：Electronic CodeBook mode（电子密码模式）
* `CBC`：Cipher Block Chaining mode（密码分组链接模式）
* `CFB`：Cipher FeedBack mode（密文反馈模式）
* `OFB`：Output FeedBack mode（输出反馈模式）
* `CTR`：CounTeR mode（计数器模式）

| **模式** | **优点** | **缺点** |
| :---: | :---: | :---: |
| ECB | 简单，利于并行计算，不会传递误差 | 不能隐藏明文的模式，可能对明文进行主动攻击 |
| CBC | 隐藏了明文模式 | 误差传递，不利于并行计算 |
| CFB | 隐藏了明文模式，分组密码转化为流模式，可以及时加密传送小于分组的数据 | 误差传递，不利于并行计算 |
| CTR | 程序实现上比较容易，可以以任意顺序对分组进行加密和解密，不会放大错误 | - |

### 填充方式

#### ANSIX923

ANSIX923填充字符串由一个字节序列组成，此字节序列的最后一个字节填充字节序列的长度，其余字节均填充数字零。  

例如：

块长度为8，数据长度为9

数据： FF FF FF FF FF FF FF FF FF，

填充： FF FF FF FF FF FF FF FF FF 00 00 00 00 00 00 07

#### ISO10126

ISO10126填充字符串由一个字节序列组成，此字节序列的最后一个字节填充字节序列的长度，其余字节填充随机数据。

例如：

块长度为8，数据长度为9

数据： FF FF FF FF FF FF FF FF FF

填充： FF FF FF FF FF FF FF FF FF XX XX XX XX XX XX 07

#### PKCSv7

PKCSv7填充字符串由一个字节序列组成，每个字节填充该字节序列的长度。 

例如：

块长度为8，数据长度为9

数据： FF FF FF FF FF FF FF FF FF

填充： FF FF FF FF FF FF FF FF FF 07 07 07 07 07 07 07

PKCSv5和PKCSv7类似，不同点在于PKCSv5填充模式明确指定了块大小为64位。

### 零填充

填充字符串由设置为零的字节组成

