## 消息摘要

### 常见算法

| **算法** | **摘要长度** | **块长度** | **循环次数** |
| :---: | :---: | :---: | :---: |
| MD2 | 128 | 128 | 18 |
| MD4 | 128 | 512 | 48 |
| MD5 | 128 | 512 | 64 |
| SHA-1 | 160 | 512 | 80 |
| SHA-224 | 224 | 512 | 64 |
| SHA-256 | 256 | 512 | 64 |
| SHA-384 | 384 | 512 | 80 |
| SHA-512 | 512 | 1024 | 80 |
| SHA-512/224 | 224 | 1024 | 80 |
| SHA-512/256 | 256 | 1024 | 80 |
| SHA3-224 | 224 | 1152 | 24 |
| SHA3-256 | 256 | 1088 | 24 |
| SHA3-384 | 384 | 832 | 24 |
| SHA3-512 | 512 | 576 | 24 |

### MD5

MD5是输入不定长度信息，输出固定长度128位的算法。经过程序流程，生成四个32位数据，最后联合起来成为一个128位散列。基本方式为，求余、取余、调整长度、与链接变量进行循环运算。得出结果。

#### 填充编码

在MD5算法中，首先需要对消息进行填充。消息的位长将扩展至$$ 512N + 448 $$，$$N$$为一个非负整数。填充的方法：在消息的后面填充一个1，其他填充为0，直到满足上面的条件时才停止填充；然后，在这个结果后面附加一个以64位二进制表示的填充前信息长度。经过这两步的处理，现在的信息的位长$$ L =512N+448+64=512(N+1) $$，即长度恰好是512的整数倍。这样做的原因是为满足后面处理中对信息长度的要求。

#### 算法实现

![](https://upload.wikimedia.org/wikipedia/commons/a/ab/MD5.png)

MD5算法由4组16次循环构成，一共64次循环。如上图所示，$$ F $$是一个非线性函数，$$ M_i $$表示一个32位的输入数据，$$ K_i $$表示一个32位常数，用来完成每次不同的计算。

MD5的主循环有4轮（MD4只有三轮），每轮循环都很相似。第一轮进行16次操作。每次操作对A、B、C和D中的其中三个进行一次非线性函数运算，然后将所得结果加上第四个变量，文本的一个子分组和一个常数。再将所得结果向左环移一个不定的数，并加上A、B、C或D之一。最后用该结果取代原来的A、B、C或D。

以下是每次操作中用到的四个非线性函数（每轮一个）。

$$ F(X,Y,Z) = (X\wedge{Y}) \vee (\neg{X} \wedge{Z})$$

$$ G(X,Y,Z) = (X\wedge{Z}) \vee (Y \wedge \neg{Z}) $$

$$ H(X,Y,Z) = X \oplus Y \oplus Z $$

$$ I(X,Y,Z) = Y \oplus (X \vee \neg{Z}) $$

